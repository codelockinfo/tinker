<div class="newsec custom-category-section">
  <div class="collection-with-slider-main-new">
    <div class="width-container">
      <div class="collection-img-main-box-new {% if section.settings.image_position == 'right' %}image-position-right{% endif %}">
        <div class="collection-img-box-new">
          {% if section.settings.responsive_img != blank %}
            <div class="collection-main-img-new">
              <a href="{{ section.settings.colurl }}">
                <img src="{{ section.settings.responsive_img | img_url: 'master' }}" alt="{{ section.settings.responsive_img.alt | default: 'Collection image' }}" class="col-img">
              </a>
            </div>
          {% endif %}
        </div>
        {% if section.settings.show_product_slider %}
        <div class="collection-slider-box-new">
          <div class="collection-slider-header" style="--heading-size: {{ section.settings.heading_font_size_desktop | default: 24 }}px; --heading-size-mobile: {{ section.settings.heading_font_size_mobile | default: 20 }}px; --heading-color: {{ section.settings.heading_color | default: '#000000' }};">
            {% if section.settings.title != blank %}
              {% render 'heading-style-banner', 
                heading: section.settings.title,
                heading_style: section.settings.heading_style,
                heading_alignment: 'center',
                wrapper_class: 'collection-slider'
              %}
            {% endif %}
            {% if section.settings.button_label != blank and section.settings.colurl != blank %}
              <a href="{{ section.settings.colurl }}" class="collection-slider-button" style="--button-font-size-desktop: {{ section.settings.button_font_size_desktop | default: 14 }}px; --button-font-size-mobile: {{ section.settings.button_font_size_mobile | default: 14 }}px; --button-bg-color: {{ section.settings.button_background_color | default: '#282828' }}; --button-text-color: {{ section.settings.button_text_color | default: '#ffffff' }}; --button-border-radius-desktop: {{ section.settings.button_border_radius_desktop | default: 4 }}px; --button-border-radius-mobile: {{ section.settings.button_border_radius_mobile | default: 4 }}px;">{{ section.settings.button_label }}</a>
            {% endif %}
          </div>
          <div class="swiper collectionSwiper-custome arrow-style-{{ section.settings.navigation_arrow_style | default: 'circle' }} {% unless section.settings.show_navigation_arrows_desktop %}hide-arrows-desktop{% endunless %} {% unless section.settings.show_navigation_arrows_mobile %}hide-arrows-mobile{% endunless %}" style="--arrow-bg-color: {{ section.settings.navigation_arrow_bg_color | default: '#ffffff' }}; --arrow-color: {{ section.settings.navigation_arrow_color | default: '#000000' }}; --arrow-bg-hover-color: {{ section.settings.navigation_arrow_bg_hover_color | default: '#000000' }}; --arrow-hover-color: {{ section.settings.navigation_arrow_hover_color | default: '#ffffff' }};">
            <div class="swiper-button-prev collection-swiper-button-prev">
            </div>
            <div class="swiper-wrapper">
              {% for product in section.settings.collectionproduct.products %}
                <div class="swiper-slide">
                  {% liquid
                    assign card_style = section.settings.product_card_style | default: 'horizontal'
                    if card_style == 'horizontal'
                      render 'product-card-horizontal', product: product, settings: section.settings
                    elsif card_style == 'vertical'
                      render 'product-card-vertical', product: product, settings: section.settings
                    else
                      render 'product-card-static', product: product, settings: section.settings
                    endif
                  %}
                </div>
              {% endfor %}
            </div>
            <div class="swiper-button-next collection-swiper-button-next">
            </div>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  {% comment %} Render quick view popups for all products (only if quick view is enabled) {% endcomment %}
  {% if section.settings.show_quick_view %}
    {% for product in section.settings.collectionproduct.products %}
      {% render 'quick-view-popup', product: product %}
    {% endfor %}
  {% endif %}
</div>
{% schema %}
{
  "name": "Banner with collection",
  "settings": [
    {
      "id": "collectionproduct",
      "type": "collection",
      "label": "Select collection"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Collection Grid"
    },
    {
      "type": "select",
      "id": "heading_style",
      "label": "Heading Style",
      "default": "simple",
      "options": [
        {
          "value": "simple",
          "label": "Simple"
        },
        {
          "value": "underline",
          "label": "Underline"
        },
        {
          "value": "line-top",
          "label": "Line Top"
        },
        {
          "value": "lines",
          "label": "Lines"
        },
        {
          "value": "diamond",
          "label": "Diamond"
        },
        {
          "value": "ornament",
          "label": "Ornament"
        },
        {
          "value": "x",
          "label": "X"
        }
      ],
      "info": "Choose the style for the heading"
    },
    {
      "type": "header",
      "content": "Heading Typography"
    },
    {
      "type": "range",
      "id": "heading_font_size_desktop",
      "label": "Heading Font Size (Desktop)",
      "min": 16,
      "max": 60,
      "step": 2,
      "default": 24,
      "unit": "px",
      "info": "Font size for heading on desktop"
    },
    {
      "type": "range",
      "id": "heading_font_size_mobile",
      "label": "Heading Font Size (Mobile)",
      "min": 14,
      "max": 40,
      "step": 2,
      "default": 20,
      "unit": "px",
      "info": "Font size for heading on mobile"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000",
      "info": "Color for the heading text"
    },
    {
      "type": "url",
      "id": "colurl",
      "label": "Collection URL"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "Shop Now"
    },
    {
      "type": "header",
      "content": "Button Styling"
    },
    {
      "type": "range",
      "id": "button_font_size_desktop",
      "label": "Button Font Size (Desktop)",
      "min": 12,
      "max": 24,
      "step": 1,
      "default": 14,
      "unit": "px",
      "info": "Font size for button on desktop"
    },
    {
      "type": "range",
      "id": "button_font_size_mobile",
      "label": "Button Font Size (Mobile)",
      "min": 12,
      "max": 20,
      "step": 1,
      "default": 14,
      "unit": "px",
      "info": "Font size for button on mobile"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Button Background Color",
      "default": "#282828",
      "info": "Background color for the button"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button Text Color",
      "default": "#ffffff",
      "info": "Text color for the button"
    },
    {
      "type": "range",
      "id": "button_border_radius_desktop",
      "label": "Button Border Radius (Desktop)",
      "min": 0,
      "max": 50,
      "step": 2,
      "default": 4,
      "unit": "px",
      "info": "Border radius for button on desktop"
    },
    {
      "type": "range",
      "id": "button_border_radius_mobile",
      "label": "Button Border Radius (Mobile)",
      "min": 0,
      "max": 50,
      "step": 2,
      "default": 4,
      "unit": "px",
      "info": "Border radius for button on mobile"
    },
    {
      "type": "image_picker",
      "id": "responsive_img",
      "label": "Collection Image",
      "info": "This image will be displayed in 40% width on desktop and full width on mobile"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image Position",
      "default": "left",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "info": "Choose whether the image appears on the left or right side"
    },
    {
      "type": "header",
      "content": "Product Slider Settings"
    },
    {
      "type": "checkbox",
      "id": "show_product_slider",
      "label": "Show Product Slider",
      "default": true,
      "info": "Toggle to show or hide the product slider section"
    },
    {
      "type": "checkbox",
      "id": "show_navigation_arrows_desktop",
      "label": "Show Navigation Arrows (Desktop)",
      "default": true,
      "info": "Toggle to show or hide prev/next arrows on desktop"
    },
    {
      "type": "checkbox",
      "id": "show_navigation_arrows_mobile",
      "label": "Show Navigation Arrows (Mobile)",
      "default": true,
      "info": "Toggle to show or hide prev/next arrows on mobile"
    },
    {
      "type": "select",
      "id": "navigation_arrow_style",
      "label": "Navigation Arrow Style",
      "default": "circle",
      "options": [
        {
          "value": "circle",
          "label": "Style 1 - Circle"
        },
        {
          "value": "square",
          "label": "Style 2 - Square"
        },
        {
          "value": "square-rounded",
          "label": "Style 3 - Square with Rounded Corners"
        }
      ],
      "info": "Choose the style for navigation arrows"
    },
    {
      "type": "header",
      "content": "Navigation Arrow Colors"
    },
    {
      "type": "color",
      "id": "navigation_arrow_bg_color",
      "label": "Arrow Background Color",
      "default": "#ffffff",
      "info": "Background color for prev/next buttons"
    },
    {
      "type": "color",
      "id": "navigation_arrow_color",
      "label": "Arrow Icon Color",
      "default": "#000000",
      "info": "Color for the arrow icons"
    },
    {
      "type": "color",
      "id": "navigation_arrow_bg_hover_color",
      "label": "Arrow Background Hover Color",
      "default": "#000000",
      "info": "Background color on hover"
    },
    {
      "type": "color",
      "id": "navigation_arrow_hover_color",
      "label": "Arrow Icon Hover Color",
      "default": "#ffffff",
      "info": "Arrow icon color on hover"
    },
    {
      "type": "range",
      "id": "slides_per_view_desktop",
      "label": "Products per Row (Desktop)",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4,
      "info": "Number of products to show per row in slider view on desktop"
    },
    {
      "type": "range",
      "id": "slides_per_view_tablet",
      "label": "Products per Row (Tablet)",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3,
      "info": "Number of products to show per row in slider view on tablet"
    },
    {
      "type": "range",
      "id": "slides_per_view_mobile",
      "label": "Products per Row (Mobile)",
      "min": 1,
      "max": 3,
      "step": 0.1,
      "default": 1.2,
      "info": "Number of products to show per row in slider view on mobile"
    },
    {
      "type": "header",
      "content": "Product Card Style"
    },
    {
      "type": "select",
      "id": "product_card_style",
      "label": "Product Card Style",
      "default": "horizontal",
      "options": [
        {
          "value": "horizontal",
          "label": "style 1"
        },
        {
          "value": "vertical",
          "label": "style 2"
        },
        {
          "value": "static",
          "label": "style 3"
        }
      ],
      "info": "Choose the product card style - horizontal or vertical hover actions, or static with both images always visible"
    },
    {
      "type": "header",
      "content": "Product Hover Options"
    },
    {
      "type": "checkbox",
      "id": "show_wishlist",
      "label": "Show Wishlist Button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_quick_view",
      "label": "Show Quick View Button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_compare",
      "label": "Show Compare Button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_add_to_cart",
      "label": "Show Add to Cart Button",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Banner with collection",
      "settings": {}
    }
  ]
}
{% endschema %}

<style>
 .newsec .product-title-custome{font-size:13px;font-weight:600;color:#000;padding:0 10px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.product-title-custome a{color:#000;text-decoration:none}.product-title-custome a:hover{text-decoration:underline}.product-price,.product-title{font-family:Varta,serif}.overflow,.product-title{overflow:hidden}*,:after,:before,input{box-sizing:border-box}user agent stylesheet div{display:block;unicode-bidi:isolate}.product-price-custome{font-size:14px}.newsec .collection-with-slider-main-new{background-color:#fff; max-width: 1440px; margin: 0 auto;}.newsec .collection-with-slider-main-new{padding:30px 0;}.newsec .collection-img-main-box-new{display:flex;flex-wrap:wrap;align-items:stretch}.newsec .collection-img-box-new{width:30%;display:flex;flex-direction:column;order:1}.newsec .collection-slider-box-new{width:70%;padding-left:15px;display:flex;flex-direction:column;height:100%;order:2}.newsec .collection-img-main-box-new.image-position-right .collection-img-box-new{order:2;padding-left:15px;padding-right:0}.newsec .collection-img-main-box-new.image-position-right .collection-slider-box-new{order:1;padding-left:0;padding-right:15px}.newsec .collection-main-img-new{display:flex;height:100%;flex:1}.newsec .collection-main-img-new img{width:100%;height:100%;object-fit:cover;display:block}
.newsec .collection-slider-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:15px}
.newsec .collection-slider-title{margin:0;font-size:24px;font-weight:600;color:#000;flex:1}

/* Heading Style Styles */
.newsec .collection-slider__heading-wrapper{flex:1;margin:0}
.newsec .collection-slider__heading{font-size:var(--heading-size, 24px);font-weight:600;color:var(--heading-color, #000);margin:0;padding:0}
.newsec .collection-slider__heading--left{text-align:left}
.newsec .collection-slider__heading--center{text-align:center}
.newsec .collection-slider__heading--right{text-align:right}

/* Style 1: Line Top */
.newsec .collection-slider__heading-container{display:flex;align-items:center;justify-content:flex-start;gap:15px}
.newsec .collection-slider__heading-container--center{justify-content:center}
.newsec .collection-slider__heading-container--right{justify-content:flex-end}
.newsec .collection-slider__heading-line-left,.newsec .collection-slider__heading-line-right{flex:0 0 auto;width:60px;height:1px;background:var(--heading-color, #000);opacity:0.3}

/* Style 2: Underline */
.newsec .collection-slider__heading-wrapper--underline{display:flex;flex-direction:column;align-items:flex-start}
.newsec .collection-slider__heading-underline{width:100%;max-width:250px;height:2px;background:var(--heading-color, #000);margin-top:10px;opacity:0.3}

/* Style 3: Lines (SVG) */
.newsec .collection-slider__heading-lines{display:flex;align-items:center;justify-content:flex-start;margin-top:10px;width:100%}
.newsec .collection-slider__heading-svg{width:100%;max-width:300px;height:auto;fill:var(--heading-color, #000);opacity:0.6}

/* Style 4: Diamond */
.newsec .collection-slider__heading-diamond{display:flex;align-items:center;justify-content:flex-start;gap:15px;margin-top:10px;width:100%}
.newsec .collection-slider__heading-diamond span{flex:1;height:1px;background:var(--heading-color, #000);opacity:0.3}
.newsec .collection-slider__heading-diamond svg{width:12px;height:12px;color:var(--heading-color, #000);opacity:0.6}

/* Style 5: Ornament */
.newsec .collection-slider__heading-ornament{display:flex;align-items:center;justify-content:flex-start;gap:15px;margin-top:10px;width:100%}
.newsec .collection-slider__heading-ornament span{flex:1;height:1px;background:var(--heading-color, #000);opacity:0.3}
.newsec .collection-slider__heading-ornament svg{width:24px;height:16px;color:var(--heading-color, #000);opacity:0.6}

/* Style 6: X */
.newsec .collection-slider__heading-x{display:flex;align-items:center;justify-content:flex-start;gap:15px;margin-top:10px;width:100%}
.newsec .collection-slider__heading-x span{flex:1;height:1px;background:var(--heading-color, #000);opacity:0.3}
.newsec .collection-slider__heading-x svg{width:12px;height:12px;color:var(--heading-color, #000);opacity:0.6}
.newsec .collection-slider-button{display:inline-block;padding:12px 30px;background-color:var(--button-bg-color, #282828);color:var(--button-text-color, #fff);text-decoration:none;border-radius:var(--button-border-radius-desktop, 4px);text-transform:capitalize;letter-spacing:1px;transition:all 0.3s ease;white-space:nowrap;font-size:var(--button-font-size-desktop, 14px)}
.newsec .collection-slider-button:hover{background-color:#000;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.2);color:var(--button-text-color, #fff)}.newsec .collection-img-box-new:only-child{width:100%}.newsec .swiper{width:100%;height:auto;position:relative}.newsec .swiper-slide{text-align:center;font-size:14px;background:#fff;display:flex;justify-content:center}.newsec .collection-swiper-button-prev,.newsec .collection-swiper-button-next{position:absolute;top:50%;transform:translateY(-50%);width:40px;height:40px;background-color:var(--arrow-bg-color, #fff);box-shadow:0 2px 8px rgba(0,0,0,0.15);cursor:pointer;z-index:10;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;color:var(--arrow-color, #000)}.newsec .collectionSwiper-custome.arrow-style-circle .collection-swiper-button-prev,.newsec .collectionSwiper-custome.arrow-style-circle .collection-swiper-button-next{border-radius:50%}.newsec .collectionSwiper-custome.arrow-style-square .collection-swiper-button-prev,.newsec .collectionSwiper-custome.arrow-style-square .collection-swiper-button-next{border-radius:0}.newsec .collectionSwiper-custome.arrow-style-square-rounded .collection-swiper-button-prev,.newsec .collectionSwiper-custome.arrow-style-square-rounded .collection-swiper-button-next{border-radius:33%}.newsec .collectionSwiper-custome.hide-arrows-desktop .collection-swiper-button-prev,.newsec .collectionSwiper-custome.hide-arrows-desktop .collection-swiper-button-next{display:none}.newsec .collection-swiper-button-prev:hover,.newsec .collection-swiper-button-next:hover{background-color:var(--arrow-bg-hover-color, #000);color:var(--arrow-hover-color, #fff);box-shadow:0 4px 12px rgba(0,0,0,0.25);transform:translateY(-50%) scale(1.1)}.newsec .collection-swiper-button-prev{left:10px}.newsec .collection-swiper-button-next{right:10px}.newsec .collection-swiper-button-prev svg,.newsec .collection-swiper-button-next svg{width:20px;height:20px;stroke:var(--arrow-color, currentColor);fill:none;transition:stroke 0.3s ease}.newsec .collection-swiper-button-prev:hover svg,.newsec .collection-swiper-button-next:hover svg{stroke:var(--arrow-hover-color, currentColor)}.newsec .collection-swiper-button-prev.swiper-button-disabled,.newsec .collection-swiper-button-next.swiper-button-disabled{opacity:0.35;cursor:auto;pointer-events:none}.newsec .swiper-slide img{display:block;width:100%;object-fit:cover}.newsec .image-collection-new{padding:10px;border:1px solid #eaeff2}.newsec .image-collection-new:hover .product-content-box{text-align:center;background-color:#fff;}.newsec .image-collection-new .product-img{position:relative;overflow:hidden;transition:all 0.5s;background-color: #F9F9F9;}.newsec .image-collection-new .main-img{transition:transform 0.5s ease,opacity 0.3s ease;transform:scale(1)}.newsec .image-collection-new:hover .main-img{transform:scale(1.1)}.newsec .hover-image{position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;transition:clip-path 0.6s ease;clip-path:inset(0 100% 0 0)}.newsec .image-collection-new:hover .hover-image{clip-path:inset(0 0% 0 0)}.newsec .product-hover-actions{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;gap:10px;opacity:0;visibility:hidden;transition:opacity 0.3s ease,visibility 0.3s ease;z-index:10}.newsec .image-collection-new:hover .product-hover-actions{opacity:1;visibility:visible}.newsec .hover-action-btn{width:45px;height:45px;border-radius:50%;background-color:#fff;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.3s ease;box-shadow:0 2px 8px rgba(0,0,0,0.15)}.newsec .hover-action-btn:hover{background-color:#000;color:#fff;transform:scale(1.1);box-shadow:0 4px 12px rgba(0,0,0,0.25)}.newsec .hover-action-btn svg{width:20px;height:20px;stroke:currentColor;fill:none}.newsec .hover-action-btn.add-to-cart-form{display:flex;padding:0}.newsec .hover-action-btn.add-to-cart-form button{width:100%;height:100%;border:none;background:transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0}.newsec .hover-action-btn.add-to-cart-form svg{fill:currentColor}.newsec .pro-rate1{margin:10px 0}.newsec .product-content-box-new{text-align:center;padding:20px}.newsec .product-content-box{padding-top:20px}.newsec .btn{background:white!important}.newsec .click-here-button-new{width:100%;margin-top:14px;border:2px solid #282828;color:#282828;text-transform:capitalize;letter-spacing:1px}.swiper-wrapper{width:100%}

/* Horizontal Card Style (Default) */
.newsec .product-card-horizontal .product-hover-actions{flex-direction:row;top:90%;left:50%}

/* Vertical Card Style */
.newsec .product-card-vertical .product-hover-actions{flex-direction:column;top:20px;left:auto;right:15px;transform:none;gap:8px}.newsec .product-card-vertical .product-hover-actions--vertical{top:20px;left:auto;right:15px;transform:none}

/* Static Card Style */
.newsec .product-card-static .product-hover-actions--static{top:90%;left:50%;flex-direction:row;opacity:1!important;visibility:visible!important}
  .swiper-navigation-icon {
    display: none !important;
  }

  .swiper-button-next::after,
  .swiper-button-prev::after {
    font-size: 16px !important;
    font-weight: bold;
  }
@media (max-width:849px){.newsec .collection-img-main-box-new{flex-direction:column}.newsec .collection-img-box-new{display:none!important}.newsec .collection-slider-box-new{width:100%;padding:0}.newsec .collection-slider-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:15px;flex-wrap:wrap;gap:15px}.newsec .collection-swiper-button-prev,.newsec .collection-swiper-button-next{width:35px;height:35px}.newsec .collectionSwiper-custome.hide-arrows-mobile .collection-swiper-button-prev,.newsec .collectionSwiper-custome.hide-arrows-mobile .collection-swiper-button-next{display:none!important}.newsec .collection-swiper-button-prev svg,.newsec .collection-swiper-button-next svg{width:16px;height:16px}.newsec .collection-swiper-button-prev{left:5px}.newsec .collection-swiper-button-next{right:5px}.newsec .collection-slider-title{font-size:20px;margin-bottom:0;flex:1}.newsec .collection-slider__heading{font-size:var(--heading-size-mobile, 20px)!important}.newsec .collection-slider__heading-wrapper{flex:1}.newsec .collection-slider-button{padding:10px 25px;font-size:var(--button-font-size-mobile, 14px)!important;width:auto;text-align:center;border-radius:var(--button-border-radius-mobile, 4px)!important;white-space:nowrap}.newsec .product-hover-actions{gap:8px}.newsec .hover-action-btn{width:40px;height:40px}.newsec .hover-action-btn svg{width:18px;height:18px}.newsec .product-card-vertical .product-hover-actions{gap:6px}}.collection-main-img-new{display:block;width:100%}.collection-main-img-new img{width:100%;height:auto;display:block;object-fit:cover}@media (max-width:375px){.add-to-cartc{margin-top:20px}.newsec .hover-action-btn{width:35px;height:35px}.newsec .hover-action-btn svg{width:16px;height:16px}}
</style>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const slidesPerViewDesktop = {{ section.settings.slides_per_view_desktop | default: 4 }};
  const slidesPerViewTablet = {{ section.settings.slides_per_view_tablet | default: 3 }};
  const slidesPerViewMobile = {{ section.settings.slides_per_view_mobile | default: 1.2 }};
  
  var swiper = new Swiper('.collectionSwiper-custome', {
    slidesPerView: slidesPerViewDesktop,  
    spaceBetween: 20,
    loop: false,
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
    },
    navigation: {
      nextEl: '.collection-swiper-button-next',
      prevEl: '.collection-swiper-button-prev',
    },
    breakpoints: {
      0: {
        slidesPerView: slidesPerViewMobile,
        spaceBetween: 10,
      },
      576: {
        slidesPerView: slidesPerViewMobile,
        spaceBetween: 15,
      },
      768: {
        slidesPerView: slidesPerViewTablet,
        spaceBetween: 20,
      },
      1024: {
        slidesPerView: slidesPerViewTablet,
        spaceBetween: 20,
      },
      1200: {
        slidesPerView: slidesPerViewDesktop,
        spaceBetween: 20,
      },
    },
  });

  // Quick view popup functionality for banner slider
  function openQuickViewPopup(productId) {
    const isMobile = window.innerWidth <= 768;
    
    // Close any existing popup
    document.querySelectorAll('[data-quick-view-popup].is-open').forEach(function(popup) {
      popup.classList.remove('is-open');
    });
    
    if (isMobile) {
      // Open mobile popup
      const mobilePopup = document.getElementById('quick-view-popup-mobile-' + productId);
      if (mobilePopup) {
        mobilePopup.classList.add('is-open');
        document.body.style.overflow = 'hidden';
      }
    } else {
      // Open desktop popup
      const desktopPopup = document.getElementById('quick-view-popup-' + productId);
      if (desktopPopup) {
        desktopPopup.classList.add('is-open');
        document.body.style.overflow = 'hidden';
      }
    }
  }

  function closeQuickViewPopup() {
    document.querySelectorAll('[data-quick-view-popup].is-open').forEach(function(popup) {
      popup.classList.remove('is-open');
    });
    document.body.style.overflow = '';
  }

  // Quick view button click handler for banner slider
  document.querySelectorAll('.newsec .quick-view-btn').forEach(function(btn) {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      const productId = this.getAttribute('data-product-id');
      if (productId) {
        openQuickViewPopup(productId);
      }
    });
  });

  // Close popup on overlay or close button click
  document.addEventListener('click', function(e) {
    const popupClose = e.target.closest('[data-popup-close]');
    if (popupClose) {
      const popup = popupClose.closest('[data-quick-view-popup]');
      if (popup && popup.classList.contains('is-open')) {
        closeQuickViewPopup();
      }
    }
  });

  // Close popup on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      const openPopup = document.querySelector('[data-quick-view-popup].is-open');
      if (openPopup) {
        closeQuickViewPopup();
      }
    }
  });

  // Prevent form submission from bubbling to parent link
  document.querySelectorAll('.add-to-cart-form').forEach(function(form) {
    form.addEventListener('submit', function(e) {
      e.stopPropagation();
    });
  });

  // AJAX Add to Cart functionality for banner slider
  document.querySelectorAll('[data-ajax-add-to-cart]').forEach(function(form) {
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      const form = e.target;
      const submitBtn = form.querySelector('button[type="submit"], input[type="submit"]');
      const variantId = submitBtn ? submitBtn.getAttribute('data-variant-id') : form.querySelector('input[name="id"]').value;
      const quantity = form.querySelector('input[name="quantity"]').value || 1;
      
      if (!variantId) {
        console.error('Variant ID not found');
        return;
      }

      // Show loading state
      const originalText = submitBtn ? submitBtn.textContent || submitBtn.innerHTML : 'Add to cart';
      if (submitBtn) {
        submitBtn.disabled = true;
        if (submitBtn.tagName === 'BUTTON') {
          submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" stroke-dasharray="32" stroke-dashoffset="32"><animate attributeName="stroke-dasharray" dur="1.5s" values="0 32;16 16;0 32;0 32" repeatCount="indefinite"/><animate attributeName="stroke-dashoffset" dur="1.5s" values="0;-16;-32;-32" repeatCount="indefinite"/></circle></svg>';
        } else {
          submitBtn.value = 'Adding...';
        }
      }

      try {
        const response = await fetch('/cart/add.js', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            items: [{
              id: variantId,
              quantity: parseInt(quantity)
            }]
          })
        });

        if (!response.ok) {
          throw new Error('Failed to add to cart');
        }

        const data = await response.json();

        // Update cart count
        const cartResponse = await fetch('/cart.js');
        if (cartResponse.ok) {
          const cart = await cartResponse.json();
          
          // Update header cart count
          document.querySelectorAll('.header__cart-count, [data-cart-count]').forEach(function(el) {
            if (cart.item_count > 0) {
              el.textContent = cart.item_count;
              el.style.display = 'flex';
            } else {
              el.style.display = 'none';
            }
          });
        }

        // Open cart drawer if it exists and refresh cart
        if (window.cartDrawer && typeof window.cartDrawer.open === 'function') {
          // Refresh cart first, then open drawer
          if (typeof window.cartDrawer.refreshCart === 'function') {
            window.cartDrawer.refreshCart().then(function() {
              setTimeout(function() {
                window.cartDrawer.open();
              }, 100);
            });
          } else {
            setTimeout(function() {
              window.cartDrawer.open();
            }, 300);
          }
        }

        // Dispatch cart updated event
        document.dispatchEvent(new CustomEvent('cart:updated', { detail: data }));

        // Show success feedback
        if (submitBtn) {
          if (submitBtn.tagName === 'BUTTON') {
            submitBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M16.6667 5L7.5 14.1667L3.33333 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
            submitBtn.style.color = '#4caf50';
          } else {
            submitBtn.value = 'Added!';
            submitBtn.style.background = '#4caf50';
            submitBtn.style.color = '#fff';
          }
          
          setTimeout(function() {
            submitBtn.disabled = false;
            if (submitBtn.tagName === 'BUTTON') {
              submitBtn.innerHTML = originalText;
              submitBtn.style.color = '';
            } else {
              submitBtn.value = originalText;
              submitBtn.style.background = '';
              submitBtn.style.color = '';
            }
          }, 2000);
        }

      } catch (error) {
        console.error('Error adding to cart:', error);
        alert('Unable to add product to cart. Please try again.');
        
        // Reset button state
        if (submitBtn) {
          submitBtn.disabled = false;
          if (submitBtn.tagName === 'BUTTON') {
            submitBtn.innerHTML = originalText;
          } else {
            submitBtn.value = originalText;
          }
        }
      }
    });
  });
});
</script>